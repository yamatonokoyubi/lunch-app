# メニュー作成・編集モーダル - 動作確認手順

## 🚀 実装完了サマリー

**Issue #88**: メニュー作成・編集フォーム実装  
**コミット**: a624056  
**ブランチ**: feature/88-implement-menu-form-modal

## ✅ 実装された機能

### 1. モーダルウィンドウ
- ✅ フェードイン・スライドアップアニメーション
- ✅ レスポンシブデザイン対応
- ✅ モーダル外クリックで閉じる
- ✅ ×ボタンとキャンセルボタンで閉じる

### 2. フォーム機能
- ✅ メニュー名（必須、100文字以内）
- ✅ 説明（任意、500文字以内、文字数カウント付き）
- ✅ 価格（必須、1円以上100,000円以下）
- ✅ ステータス（公開中/非公開）
- ✅ 画像URL（任意）

### 3. バリデーション
- ✅ リアルタイムバリデーション（入力と同時にチェック）
- ✅ エラー時の視覚的フィードバック（赤枠、エラーメッセージ）
- ✅ フォーム送信前の最終チェック
- ✅ APIバリデーションエラーの表示

### 4. API連携
- ✅ POST /api/store/menus でメニュー作成
- ✅ PUT /api/store/menus/{id} でメニュー更新
- ✅ 成功時にトースト通知
- ✅ 一覧の自動更新

## 🧪 動作確認手順

### 準備

1. **Dockerコンテナを起動**
   ```bash
   docker-compose up -d
   ```

2. **ブラウザでアクセス**
   ```
   http://localhost:8000
   ```

3. **店舗スタッフでログイン**
   - ユーザー名: `admin`
   - パスワード: `admin@123`

4. **メニュー管理画面へ移動**
   - ヘッダーの「メニュー管理」をクリック
   - または直接: http://localhost:8000/store/menus

### テストケース

#### ✅ テスト1: 新規作成

1. **モーダルを開く**
   - 「+ メニュー追加」ボタンをクリック
   - ✅ モーダルがスムーズにフェードイン
   - ✅ タイトルが「メニュー追加」になっている
   - ✅ フォームが空で、ステータスが「公開中」

2. **バリデーションテスト**
   - メニュー名を空のまま「保存」をクリック
   - ✅ エラーメッセージ「メニュー名は必須です」が表示
   - ✅ 入力フィールドが赤枠になる
   - ✅ トースト「入力内容を確認してください」が表示

   - 価格を0にして「保存」をクリック
   - ✅ エラーメッセージ「価格は1円以上を入力してください」が表示

3. **正常なデータで作成**
   - メニュー名: `テスト弁当`
   - 説明: `動作確認用のテストメニューです`
   - 価格: `500`
   - ステータス: `公開中`
   - 画像URL: (空でOK)
   - 「保存」をクリック

   - ✅ ボタンが「保存中...」に変化
   - ✅ トースト「メニューを追加しました」が表示
   - ✅ モーダルが自動的に閉じる
   - ✅ メニュー一覧に新しいメニューが表示される

#### ✅ テスト2: 編集

1. **モーダルを開く**
   - 一覧から「テスト弁当」の「✏️ 編集」ボタンをクリック
   - ✅ モーダルが開く
   - ✅ タイトルが「メニュー編集」になっている
   - ✅ フォームに既存データがセットされている

2. **データを変更**
   - メニュー名: `テスト弁当（改）`
   - 価格: `550`
   - 「保存」をクリック

   - ✅ トースト「メニューを更新しました」が表示
   - ✅ モーダルが閉じる
   - ✅ 一覧が更新され、変更が反映されている

#### ✅ テスト3: バリデーション詳細

1. **文字数カウント**
   - 説明欄に長いテキストを入力
   - ✅ 文字数カウンターが更新される
   - ✅ 500文字を超えると入力できない

2. **価格の範囲チェック**
   - 価格に`100001`を入力
   - ✅ エラーメッセージ「価格は100,000円以下で入力してください」が表示

3. **リアルタイムバリデーション**
   - メニュー名を空にする → エラー表示
   - メニュー名を入力 → エラーが消える
   - ✅ リアルタイムでバリデーションが動作

#### ✅ テスト4: モーダル操作

1. **モーダル外クリック**
   - モーダルの背景（グレーの部分）をクリック
   - ✅ モーダルが閉じる

2. **×ボタン**
   - モーダルを開いて、右上の×ボタンをクリック
   - ✅ モーダルが閉じる

3. **キャンセルボタン**
   - モーダルを開いて、「キャンセル」ボタンをクリック
   - ✅ モーダルが閉じる

#### ✅ テスト5: レスポンシブ

1. **デスクトップ（1920x1080）**
   - ✅ モーダルが画面中央に表示
   - ✅ 最大幅600px

2. **タブレット（768x1024）**
   - ブラウザの開発者ツールでタブレットモードに切り替え
   - ✅ モーダルが適切に表示
   - ✅ フォーム行が1カラムに変更

3. **モバイル（375x667）**
   - スマートフォンモードに切り替え
   - ✅ モーダルが画面幅95%
   - ✅ ボタンが全幅に変更
   - ✅ スクロール可能

### エラーケースのテスト

#### ❌ APIエラー

**シミュレーション方法:**
- ブラウザの開発者ツールを開く
- Network タブで API リクエストをブロック

**期待される動作:**
- ✅ トースト「メニューの保存に失敗しました」が表示
- ✅ モーダルは開いたまま
- ✅ ボタンが再度有効化される

## 📊 チェックリスト

### 機能チェック

- [ ] 新規作成モーダルが正しく開く
- [ ] 編集モーダルが正しく開き、既存データがセットされる
- [ ] メニュー名のバリデーションが動作
- [ ] 価格のバリデーションが動作
- [ ] 文字数カウントが動作
- [ ] 作成APIが正常に呼ばれる
- [ ] 更新APIが正常に呼ばれる
- [ ] 成功時にトースト通知が表示される
- [ ] 成功後に一覧が自動更新される
- [ ] モーダル外クリックで閉じる
- [ ] ×ボタンで閉じる
- [ ] キャンセルボタンで閉じる

### UI/UXチェック

- [ ] アニメーションがスムーズ
- [ ] エラーメッセージがわかりやすい
- [ ] ボタンの状態変化が適切
- [ ] レスポンシブデザインが正しく動作
- [ ] フォントサイズが読みやすい
- [ ] カラーリングが適切

### アクセシビリティチェック

- [ ] キーボードでフォーカス移動可能
- [ ] required属性が正しく設定
- [ ] placeholder が適切
- [ ] エラーメッセージが読み上げ可能

## 🐛 トラブルシューティング

### 問題: モーダルが開かない

**確認事項:**
- ✅ JavaScript エラーがないか（ブラウザコンソール確認）
- ✅ `store_menus.js` が正しく読み込まれているか
- ✅ `MenuModal.init()` が呼ばれているか

### 問題: フォーム送信時にエラー

**確認事項:**
- ✅ APIエンドポイントが存在するか
- ✅ 認証トークンが有効か
- ✅ ネットワークタブでリクエスト/レスポンスを確認

### 問題: バリデーションが動作しない

**確認事項:**
- ✅ input イベントリスナーが登録されているか
- ✅ エラー要素のIDが正しいか
- ✅ CSS でエラーが非表示になっていないか

## 🎯 次のステップ

1. **手動テストを実施**
   - 上記のテストケースをすべて確認

2. **スクリーンショットを撮影**
   - 新規作成モーダル
   - 編集モーダル
   - バリデーションエラー
   - 成功時のトースト

3. **プッシュ & Pull Request作成**
   ```bash
   git push origin feature/88-implement-menu-form-modal
   ```

4. **Issue #89 開始**
   - メニュー削除機能の実装

---

**テスト担当**: 全員  
**承認**: プロジェクトリーダー
